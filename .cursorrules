# Cursor Rules for screeps-typescript

## Development Environment

### Node Version Management
- This project uses **nvm** (Node Version Manager) to manage Node.js versions
- Node.js is installed via nvm, not system package managers
- If you need to run Node/npm/yarn commands, ensure nvm is properly configured

## Code Quality Standards

### Pre-commit Checks
Before any code changes are considered complete, always run:
```bash
yarn precommit
```

This command runs:
- Prettier formatting
- ESLint fixes
- Unit tests
- Build/compilation

All checks must pass before the code is ready to commit. If any check fails, fix the issues before proceeding.

### Type Safety
- Use type guards instead of unsafe type casts (e.g., `as unknown as`)
- Prefer proper type definitions over `any`
- Add type annotations when TypeScript can't infer types

### Import Organization
- Follow the `sort-imports` ESLint rule
- Group imports logically (external libraries, internal modules, types)
- Keep imports alphabetically sorted within groups

## Screeps Console Access

### What's Accessible in Console
The user can access:
- **Screeps built-in globals**: `Memory`, `Game`, `_` (lodash), etc.
- **Custom functions**: ONLY if explicitly exposed on the `global` object

### Custom Functions
- DO NOT suggest calling custom functions directly (e.g., `getConstructionFeaturesV3()`)
- ONLY suggest using functions exposed on `global` (e.g., `global.functionName()`)
- When debugging is needed, create new global helper functions in `src/utils/globals.ts`
- All console-accessible custom functions must be explicitly added to the global object

### Examples

**Accessing Screeps built-ins (GOOD):**
```javascript
Memory.rooms['W1N54']
Game.gcl.level
Object.keys(Game.rooms)
```

**Calling custom functions:**

BAD:
```javascript
const features = getConstructionFeaturesV3('W1N54')  // Not accessible!
```

GOOD:
```javascript
global.debugRoom('W1N54')  // Explicitly exposed on global
```

